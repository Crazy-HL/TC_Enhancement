{"ast":null,"code":"import { computed } from \"vue\";\nexport default {\n  __name: 'CommentStats',\n  props: {\n    comments: {\n      type: Array,\n      required: true\n    },\n    showStandpointChart: {\n      type: Boolean,\n      default: true\n    },\n    showEmotionChart: {\n      type: Boolean,\n      default: true\n    }\n  },\n  setup(__props, _ref) {\n    let {\n      expose: __expose\n    } = _ref;\n    __expose();\n    const props = __props;\n\n    // 计算立场分布\n    const standpointStats = computed(() => {\n      const stats = {\n        support: 0,\n        oppose: 0,\n        neutral: 0,\n        total: 0\n      };\n      props.comments.forEach(comment => {\n        if (comment.standpoint === 1) stats.support++;else if (comment.standpoint === -1) stats.oppose++;else stats.neutral++;\n        stats.total++;\n      });\n      return stats;\n    });\n\n    // 计算立场百分比\n    const standpointPercent = computed(() => {\n      const {\n        support,\n        oppose,\n        neutral,\n        total\n      } = standpointStats.value;\n      return {\n        support: total > 0 ? Math.round(support / total * 100) : 0,\n        oppose: total > 0 ? Math.round(oppose / total * 100) : 0,\n        neutral: total > 0 ? Math.round(neutral / total * 100) : 0\n      };\n    });\n\n    // 计算情感分布\n    const emotionStats = computed(() => {\n      const stats = {\n        positive: 0,\n        negative: 0,\n        neutral: 0,\n        total: 0\n      };\n      props.comments.forEach(comment => {\n        if (comment.emotion === 1) stats.positive++;else if (comment.emotion === -1) stats.negative++;else stats.neutral++;\n        stats.total++;\n      });\n      return stats;\n    });\n\n    // 计算情感百分比\n    const emotionPercent = computed(() => {\n      const {\n        positive,\n        negative,\n        neutral,\n        total\n      } = emotionStats.value;\n      return {\n        positive: total > 0 ? Math.round(positive / total * 100) : 0,\n        negative: total > 0 ? Math.round(negative / total * 100) : 0,\n        neutral: total > 0 ? Math.round(neutral / total * 100) : 0\n      };\n    });\n\n    // 饼图样式计算\n    const pieChartStyle = computed(() => {\n      return {\n        \"--positive-percent\": `${emotionPercent.value.positive}%`,\n        \"--negative-percent\": `${emotionPercent.value.negative}%`,\n        \"--neutral-percent\": `${emotionPercent.value.neutral}%`\n      };\n    });\n    const positiveSegmentStyle = computed(() => {\n      const deg = emotionPercent.value.positive / 100 * 360;\n      return {\n        \"--deg\": `${deg}deg`\n      };\n    });\n    const negativeSegmentStyle = computed(() => {\n      const positiveDeg = emotionPercent.value.positive / 100 * 360;\n      const deg = emotionPercent.value.negative / 100 * 360;\n      return {\n        \"--deg\": `${deg}deg`,\n        \"--start-deg\": `${positiveDeg}deg`\n      };\n    });\n    const neutralSegmentStyle = computed(() => {\n      const positiveDeg = emotionPercent.value.positive / 100 * 360;\n      const negativeDeg = emotionPercent.value.negative / 100 * 360;\n      const deg = emotionPercent.value.neutral / 100 * 360;\n      return {\n        \"--deg\": `${deg}deg`,\n        \"--start-deg\": `${positiveDeg + negativeDeg}deg`\n      };\n    });\n    const __returned__ = {\n      props,\n      standpointStats,\n      standpointPercent,\n      emotionStats,\n      emotionPercent,\n      pieChartStyle,\n      positiveSegmentStyle,\n      negativeSegmentStyle,\n      neutralSegmentStyle,\n      computed\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["computed","props","__props","standpointStats","stats","support","oppose","neutral","total","comments","forEach","comment","standpoint","standpointPercent","value","Math","round","emotionStats","positive","negative","emotion","emotionPercent","pieChartStyle","positiveSegmentStyle","deg","negativeSegmentStyle","positiveDeg","neutralSegmentStyle","negativeDeg"],"sources":["D:/ZhiHu/zhihu-bullet/wikitable-vue/client/src/components/CommentStats.vue"],"sourcesContent":["<template>\r\n\t<div class=\"comment-stats-container\">\r\n\t\t<!-- 立场堆叠图 (放在句子前面) -->\r\n\t\t<div v-if=\"showStandpointChart\" class=\"standpoint-chart\">\r\n\t\t\t<div class=\"chart-title\">评论立场分布</div>\r\n\t\t\t<div class=\"stacked-bar\">\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\"bar-segment support\"\r\n\t\t\t\t\t:style=\"{ width: `${standpointPercent.support}%` }\"\r\n\t\t\t\t\t:title=\"`支持: ${standpointPercent.support}%`\"></div>\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\"bar-segment neutral\"\r\n\t\t\t\t\t:style=\"{ width: `${standpointPercent.neutral}%` }\"\r\n\t\t\t\t\t:title=\"`中立: ${standpointPercent.neutral}%`\"></div>\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\"bar-segment oppose\"\r\n\t\t\t\t\t:style=\"{ width: `${standpointPercent.oppose}%` }\"\r\n\t\t\t\t\t:title=\"`反对: ${standpointPercent.oppose}%`\"></div>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"chart-legend\">\r\n\t\t\t\t<span class=\"legend-item support\"\r\n\t\t\t\t\t>支持 {{ standpointPercent.support }}%</span\r\n\t\t\t\t>\r\n\t\t\t\t<span class=\"legend-item neutral\"\r\n\t\t\t\t\t>中立 {{ standpointPercent.neutral }}%</span\r\n\t\t\t\t>\r\n\t\t\t\t<span class=\"legend-item oppose\"\r\n\t\t\t\t\t>反对 {{ standpointPercent.oppose }}%</span\r\n\t\t\t\t>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<!-- 情感饼图 (放在句子后面) -->\r\n\t\t<div v-if=\"showEmotionChart\" class=\"emotion-chart\">\r\n\t\t\t<div class=\"chart-title\">评论情感分布</div>\r\n\t\t\t<div class=\"pie-chart\" :style=\"pieChartStyle\">\r\n\t\t\t\t<div class=\"pie-segment positive\" :style=\"positiveSegmentStyle\"></div>\r\n\t\t\t\t<div class=\"pie-segment negative\" :style=\"negativeSegmentStyle\"></div>\r\n\t\t\t\t<div class=\"pie-segment neutral\" :style=\"neutralSegmentStyle\"></div>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"chart-legend\">\r\n\t\t\t\t<span class=\"legend-item positive\"\r\n\t\t\t\t\t>积极 {{ emotionPercent.positive }}%</span\r\n\t\t\t\t>\r\n\t\t\t\t<span class=\"legend-item negative\"\r\n\t\t\t\t\t>消极 {{ emotionPercent.negative }}%</span\r\n\t\t\t\t>\r\n\t\t\t\t<span class=\"legend-item neutral\"\r\n\t\t\t\t\t>中立 {{ emotionPercent.neutral }}%</span\r\n\t\t\t\t>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script setup>\r\n\timport { computed } from \"vue\";\r\n\r\n\tconst props = defineProps({\r\n\t\tcomments: {\r\n\t\t\ttype: Array,\r\n\t\t\trequired: true\r\n\t\t},\r\n\t\tshowStandpointChart: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: true\r\n\t\t},\r\n\t\tshowEmotionChart: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: true\r\n\t\t}\r\n\t});\r\n\r\n\t// 计算立场分布\r\n\tconst standpointStats = computed(() => {\r\n\t\tconst stats = {\r\n\t\t\tsupport: 0,\r\n\t\t\toppose: 0,\r\n\t\t\tneutral: 0,\r\n\t\t\ttotal: 0\r\n\t\t};\r\n\r\n\t\tprops.comments.forEach(comment => {\r\n\t\t\tif (comment.standpoint === 1) stats.support++;\r\n\t\t\telse if (comment.standpoint === -1) stats.oppose++;\r\n\t\t\telse stats.neutral++;\r\n\t\t\tstats.total++;\r\n\t\t});\r\n\r\n\t\treturn stats;\r\n\t});\r\n\r\n\t// 计算立场百分比\r\n\tconst standpointPercent = computed(() => {\r\n\t\tconst { support, oppose, neutral, total } = standpointStats.value;\r\n\r\n\t\treturn {\r\n\t\t\tsupport: total > 0 ? Math.round((support / total) * 100) : 0,\r\n\t\t\toppose: total > 0 ? Math.round((oppose / total) * 100) : 0,\r\n\t\t\tneutral: total > 0 ? Math.round((neutral / total) * 100) : 0\r\n\t\t};\r\n\t});\r\n\r\n\t// 计算情感分布\r\n\tconst emotionStats = computed(() => {\r\n\t\tconst stats = {\r\n\t\t\tpositive: 0,\r\n\t\t\tnegative: 0,\r\n\t\t\tneutral: 0,\r\n\t\t\ttotal: 0\r\n\t\t};\r\n\r\n\t\tprops.comments.forEach(comment => {\r\n\t\t\tif (comment.emotion === 1) stats.positive++;\r\n\t\t\telse if (comment.emotion === -1) stats.negative++;\r\n\t\t\telse stats.neutral++;\r\n\t\t\tstats.total++;\r\n\t\t});\r\n\r\n\t\treturn stats;\r\n\t});\r\n\r\n\t// 计算情感百分比\r\n\tconst emotionPercent = computed(() => {\r\n\t\tconst { positive, negative, neutral, total } = emotionStats.value;\r\n\r\n\t\treturn {\r\n\t\t\tpositive: total > 0 ? Math.round((positive / total) * 100) : 0,\r\n\t\t\tnegative: total > 0 ? Math.round((negative / total) * 100) : 0,\r\n\t\t\tneutral: total > 0 ? Math.round((neutral / total) * 100) : 0\r\n\t\t};\r\n\t});\r\n\r\n\t// 饼图样式计算\r\n\tconst pieChartStyle = computed(() => {\r\n\t\treturn {\r\n\t\t\t\"--positive-percent\": `${emotionPercent.value.positive}%`,\r\n\t\t\t\"--negative-percent\": `${emotionPercent.value.negative}%`,\r\n\t\t\t\"--neutral-percent\": `${emotionPercent.value.neutral}%`\r\n\t\t};\r\n\t});\r\n\r\n\tconst positiveSegmentStyle = computed(() => {\r\n\t\tconst deg = (emotionPercent.value.positive / 100) * 360;\r\n\t\treturn { \"--deg\": `${deg}deg` };\r\n\t});\r\n\r\n\tconst negativeSegmentStyle = computed(() => {\r\n\t\tconst positiveDeg = (emotionPercent.value.positive / 100) * 360;\r\n\t\tconst deg = (emotionPercent.value.negative / 100) * 360;\r\n\t\treturn { \"--deg\": `${deg}deg`, \"--start-deg\": `${positiveDeg}deg` };\r\n\t});\r\n\r\n\tconst neutralSegmentStyle = computed(() => {\r\n\t\tconst positiveDeg = (emotionPercent.value.positive / 100) * 360;\r\n\t\tconst negativeDeg = (emotionPercent.value.negative / 100) * 360;\r\n\t\tconst deg = (emotionPercent.value.neutral / 100) * 360;\r\n\t\treturn {\r\n\t\t\t\"--deg\": `${deg}deg`,\r\n\t\t\t\"--start-deg\": `${positiveDeg + negativeDeg}deg`\r\n\t\t};\r\n\t});\r\n</script>\r\n\r\n<style scoped>\r\n\t.comment-stats-container {\r\n\t\tdisplay: inline-flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 10px;\r\n\t\tmargin: 5px 0;\r\n\t}\r\n\r\n\t.chart-title {\r\n\t\tfont-size: 12px;\r\n\t\tcolor: #666;\r\n\t\tmargin-bottom: 5px;\r\n\t}\r\n\r\n\t/* 立场堆叠图样式 */\r\n\t.stacked-bar {\r\n\t\tdisplay: flex;\r\n\t\theight: 16px;\r\n\t\twidth: 100px;\r\n\t\tborder-radius: 8px;\r\n\t\toverflow: hidden;\r\n\t\tbackground: #f0f0f0;\r\n\t}\r\n\r\n\t.bar-segment {\r\n\t\theight: 100%;\r\n\t\ttransition: width 0.3s ease;\r\n\t}\r\n\r\n\t.bar-segment.support {\r\n\t\tbackground-color: #4caf50;\r\n\t}\r\n\r\n\t.bar-segment.neutral {\r\n\t\tbackground-color: #ffc107;\r\n\t}\r\n\r\n\t.bar-segment.oppose {\r\n\t\tbackground-color: #f44336;\r\n\t}\r\n\r\n\t/* 情感饼图样式 */\r\n\t.pie-chart {\r\n\t\tposition: relative;\r\n\t\twidth: 60px;\r\n\t\theight: 60px;\r\n\t\tborder-radius: 50%;\r\n\t\tbackground: conic-gradient(\r\n\t\t\t#4caf50 0% var(--positive-percent),\r\n\t\t\t#f44336 var(--positive-percent)\r\n\t\t\t\tcalc(var(--positive-percent) + var(--negative-percent)),\r\n\t\t\t#ffc107 calc(var(--positive-percent) + var(--negative-percent)) 100%\r\n\t\t);\r\n\t}\r\n\r\n\t.pie-segment {\r\n\t\tposition: absolute;\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tborder-radius: 50%;\r\n\t\tclip-path: polygon(50% 50%, 50% 0%, 100% 0%, 100% 50%);\r\n\t\ttransform: rotate(var(--deg));\r\n\t\ttransform-origin: 50% 50%;\r\n\t}\r\n\r\n\t.pie-segment.positive {\r\n\t\tbackground-color: #4caf50;\r\n\t\ttransform: rotate(var(--deg));\r\n\t}\r\n\r\n\t.pie-segment.negative {\r\n\t\tbackground-color: #f44336;\r\n\t\ttransform: rotate(var(--start-deg)) rotate(var(--deg));\r\n\t}\r\n\r\n\t.pie-segment.neutral {\r\n\t\tbackground-color: #ffc107;\r\n\t\ttransform: rotate(calc(var(--start-deg))) rotate(var(--deg));\r\n\t}\r\n\r\n\t/* 图例样式 */\r\n\t.chart-legend {\r\n\t\tdisplay: flex;\r\n\t\tflex-wrap: wrap;\r\n\t\tgap: 6px;\r\n\t\tfont-size: 11px;\r\n\t\tmargin-top: 5px;\r\n\t}\r\n\r\n\t.legend-item {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.legend-item::before {\r\n\t\tcontent: \"\";\r\n\t\tdisplay: inline-block;\r\n\t\twidth: 10px;\r\n\t\theight: 10px;\r\n\t\tmargin-right: 3px;\r\n\t\tborder-radius: 2px;\r\n\t}\r\n\r\n\t.legend-item.positive::before {\r\n\t\tbackground-color: #4caf50;\r\n\t}\r\n\r\n\t.legend-item.negative::before {\r\n\t\tbackground-color: #f44336;\r\n\t}\r\n\r\n\t.legend-item.neutral::before {\r\n\t\tbackground-color: #ffc107;\r\n\t}\r\n\r\n\t.legend-item.support::before {\r\n\t\tbackground-color: #4caf50;\r\n\t}\r\n\r\n\t.legend-item.oppose::before {\r\n\t\tbackground-color: #f44336;\r\n\t}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}