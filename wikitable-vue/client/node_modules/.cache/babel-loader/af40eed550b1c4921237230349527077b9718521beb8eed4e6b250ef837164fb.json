{"ast":null,"code":"import { computed } from \"vue\";\nexport default {\n  __name: 'ChartLegend',\n  props: {\n    comments: {\n      type: Array,\n      required: true\n    }\n  },\n  setup(__props, _ref) {\n    let {\n      expose: __expose\n    } = _ref;\n    __expose();\n    const props = __props;\n\n    // 情感数据计算\n    const emotionStats = computed(() => {\n      const stats = {\n        positive: 0,\n        negative: 0,\n        neutral: 0,\n        total: 0\n      };\n      props.comments.forEach(comment => {\n        if (comment.emotion === 1) stats.positive++;else if (comment.emotion === -1) stats.negative++;else stats.neutral++;\n        stats.total++;\n      });\n\n      // 计算百分比\n      return {\n        positive: stats.total > 0 ? Math.round(stats.positive / stats.total * 100) : 0,\n        negative: stats.total > 0 ? Math.round(stats.negative / stats.total * 100) : 0,\n        neutral: stats.total > 0 ? Math.round(stats.neutral / stats.total * 100) : 0\n      };\n    });\n\n    // 立场数据计算\n    const standpointStats = computed(() => {\n      const stats = {\n        support: 0,\n        oppose: 0,\n        neutral: 0,\n        total: 0\n      };\n      props.comments.forEach(comment => {\n        if (comment.standpoint === 1) stats.support++;else if (comment.standpoint === -1) stats.oppose++;else stats.neutral++;\n        stats.total++;\n      });\n\n      // 计算百分比\n      return {\n        support: stats.total > 0 ? Math.round(stats.support / stats.total * 100) : 0,\n        oppose: stats.total > 0 ? Math.round(stats.oppose / stats.total * 100) : 0,\n        neutral: stats.total > 0 ? Math.round(stats.neutral / stats.total * 100) : 0\n      };\n    });\n\n    // 饼图样式\n    const pieChartStyle = computed(() => {\n      return {\n        background: `conic-gradient(\n      #4CAF50 0% ${emotionStats.value.positive}%,\n      #F44336 ${emotionStats.value.positive}% ${emotionStats.value.positive + emotionStats.value.negative}%,\n      #FFC107 ${emotionStats.value.positive + emotionStats.value.negative}% 100%\n    )`\n      };\n    });\n\n    // 图注配置\n    const emotionLegend = [{\n      label: \"积极\",\n      key: \"positive\",\n      color: \"#4CAF50\"\n    }, {\n      label: \"消极\",\n      key: \"negative\",\n      color: \"#F44336\"\n    }, {\n      label: \"中立\",\n      key: \"neutral\",\n      color: \"#FFC107\"\n    }];\n    const standpointLegend = [{\n      label: \"支持\",\n      key: \"support\",\n      color: \"#4CAF50\"\n    }, {\n      label: \"反对\",\n      key: \"oppose\",\n      color: \"#F44336\"\n    }, {\n      label: \"中立\",\n      key: \"neutral\",\n      color: \"#FFC107\"\n    }];\n    const __returned__ = {\n      props,\n      emotionStats,\n      standpointStats,\n      pieChartStyle,\n      emotionLegend,\n      standpointLegend,\n      computed\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["computed","props","__props","emotionStats","stats","positive","negative","neutral","total","comments","forEach","comment","emotion","Math","round","standpointStats","support","oppose","standpoint","pieChartStyle","background","value","emotionLegend","label","key","color","standpointLegend"],"sources":["D:/ZhiHu/zhihu-bullet/wikitable-vue/client/src/components/ChartLegend.vue"],"sourcesContent":["<template>\r\n\t<div class=\"chart-legend-container\">\r\n\t\t<div class=\"chart-group\">\r\n\t\t\t<h4>情感分布</h4>\r\n\t\t\t<div class=\"pie-chart-container\">\r\n\t\t\t\t<div class=\"pie-chart\" :style=\"pieChartStyle\"></div>\r\n\t\t\t\t<div class=\"pie-legend\">\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tv-for=\"item in emotionLegend\"\r\n\t\t\t\t\t\t:key=\"item.label\"\r\n\t\t\t\t\t\tclass=\"legend-item\">\r\n\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\tclass=\"legend-color\"\r\n\t\t\t\t\t\t\t:style=\"{ backgroundColor: item.color }\"></span>\r\n\t\t\t\t\t\t<span class=\"legend-label\"\r\n\t\t\t\t\t\t\t>{{ item.label }} ({{ emotionStats[item.key] }}%)</span\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class=\"chart-group\">\r\n\t\t\t<h4>立场分布</h4>\r\n\t\t\t<div class=\"bar-chart-container\">\r\n\t\t\t\t<div class=\"bar-chart\">\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tv-for=\"item in standpointLegend\"\r\n\t\t\t\t\t\t:key=\"item.label\"\r\n\t\t\t\t\t\tclass=\"bar-segment\"\r\n\t\t\t\t\t\t:style=\"{\r\n\t\t\t\t\t\t\theight: `${standpointStats[item.key]}%`,\r\n\t\t\t\t\t\t\tbackgroundColor: item.color\r\n\t\t\t\t\t\t}\"\r\n\t\t\t\t\t\t:title=\"`${item.label}: ${standpointStats[item.key]}%`\"></div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"bar-legend\">\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tv-for=\"item in standpointLegend\"\r\n\t\t\t\t\t\t:key=\"item.label\"\r\n\t\t\t\t\t\tclass=\"legend-item\">\r\n\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\tclass=\"legend-color\"\r\n\t\t\t\t\t\t\t:style=\"{ backgroundColor: item.color }\"></span>\r\n\t\t\t\t\t\t<span class=\"legend-label\"\r\n\t\t\t\t\t\t\t>{{ item.label }} ({{ standpointStats[item.key] }}%)</span\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script setup>\r\n\timport { computed } from \"vue\";\r\n\r\n\tconst props = defineProps({\r\n\t\tcomments: {\r\n\t\t\ttype: Array,\r\n\t\t\trequired: true\r\n\t\t}\r\n\t});\r\n\r\n\t// 情感数据计算\r\n\tconst emotionStats = computed(() => {\r\n\t\tconst stats = { positive: 0, negative: 0, neutral: 0, total: 0 };\r\n\r\n\t\tprops.comments.forEach(comment => {\r\n\t\t\tif (comment.emotion === 1) stats.positive++;\r\n\t\t\telse if (comment.emotion === -1) stats.negative++;\r\n\t\t\telse stats.neutral++;\r\n\t\t\tstats.total++;\r\n\t\t});\r\n\r\n\t\t// 计算百分比\r\n\t\treturn {\r\n\t\t\tpositive:\r\n\t\t\t\tstats.total > 0 ? Math.round((stats.positive / stats.total) * 100) : 0,\r\n\t\t\tnegative:\r\n\t\t\t\tstats.total > 0 ? Math.round((stats.negative / stats.total) * 100) : 0,\r\n\t\t\tneutral:\r\n\t\t\t\tstats.total > 0 ? Math.round((stats.neutral / stats.total) * 100) : 0\r\n\t\t};\r\n\t});\r\n\r\n\t// 立场数据计算\r\n\tconst standpointStats = computed(() => {\r\n\t\tconst stats = { support: 0, oppose: 0, neutral: 0, total: 0 };\r\n\r\n\t\tprops.comments.forEach(comment => {\r\n\t\t\tif (comment.standpoint === 1) stats.support++;\r\n\t\t\telse if (comment.standpoint === -1) stats.oppose++;\r\n\t\t\telse stats.neutral++;\r\n\t\t\tstats.total++;\r\n\t\t});\r\n\r\n\t\t// 计算百分比\r\n\t\treturn {\r\n\t\t\tsupport:\r\n\t\t\t\tstats.total > 0 ? Math.round((stats.support / stats.total) * 100) : 0,\r\n\t\t\toppose:\r\n\t\t\t\tstats.total > 0 ? Math.round((stats.oppose / stats.total) * 100) : 0,\r\n\t\t\tneutral:\r\n\t\t\t\tstats.total > 0 ? Math.round((stats.neutral / stats.total) * 100) : 0\r\n\t\t};\r\n\t});\r\n\r\n\t// 饼图样式\r\n\tconst pieChartStyle = computed(() => {\r\n\t\treturn {\r\n\t\t\tbackground: `conic-gradient(\r\n      #4CAF50 0% ${emotionStats.value.positive}%,\r\n      #F44336 ${emotionStats.value.positive}% ${\r\n\t\t\t\temotionStats.value.positive + emotionStats.value.negative\r\n\t\t\t}%,\r\n      #FFC107 ${emotionStats.value.positive + emotionStats.value.negative}% 100%\r\n    )`\r\n\t\t};\r\n\t});\r\n\r\n\t// 图注配置\r\n\tconst emotionLegend = [\r\n\t\t{ label: \"积极\", key: \"positive\", color: \"#4CAF50\" },\r\n\t\t{ label: \"消极\", key: \"negative\", color: \"#F44336\" },\r\n\t\t{ label: \"中立\", key: \"neutral\", color: \"#FFC107\" }\r\n\t];\r\n\r\n\tconst standpointLegend = [\r\n\t\t{ label: \"支持\", key: \"support\", color: \"#4CAF50\" },\r\n\t\t{ label: \"反对\", key: \"oppose\", color: \"#F44336\" },\r\n\t\t{ label: \"中立\", key: \"neutral\", color: \"#FFC107\" }\r\n\t];\r\n</script>\r\n\r\n<style scoped>\r\n\t.chart-legend-container {\r\n\t\tposition: fixed;\r\n\t\ttop: 20px;\r\n\t\tright: 280px; /* 放在控制面板左侧 */\r\n\t\tz-index: 99;\r\n\t\tbackground: white;\r\n\t\tpadding: 12px;\r\n\t\tborder-radius: 8px;\r\n\t\tbox-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\r\n\t\tdisplay: flex;\r\n\t\tgap: 20px;\r\n\t\tmax-width: 400px;\r\n\t}\r\n\r\n\t.chart-group {\r\n\t\tflex: 1;\r\n\t\tmin-width: 160px;\r\n\t}\r\n\r\n\t.chart-group h4 {\r\n\t\tmargin: 0 0 8px 0;\r\n\t\tfont-size: 14px;\r\n\t\tcolor: #333;\r\n\t\ttext-align: center;\r\n\t}\r\n\r\n\t.pie-chart-container {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 10px;\r\n\t}\r\n\r\n\t.pie-chart {\r\n\t\twidth: 60px;\r\n\t\theight: 60px;\r\n\t\tborder-radius: 50%;\r\n\t}\r\n\r\n\t.bar-chart-container {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 10px;\r\n\t}\r\n\r\n\t.bar-chart {\r\n\t\twidth: 20px;\r\n\t\theight: 60px;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tjustify-content: flex-end;\r\n\t}\r\n\r\n\t.bar-segment {\r\n\t\twidth: 100%;\r\n\t\ttransition: height 0.3s ease;\r\n\t}\r\n\r\n\t.pie-legend,\r\n\t.bar-legend {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 6px;\r\n\t}\r\n\r\n\t.legend-item {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tfont-size: 12px;\r\n\t}\r\n\r\n\t.legend-color {\r\n\t\tdisplay: inline-block;\r\n\t\twidth: 12px;\r\n\t\theight: 12px;\r\n\t\tborder-radius: 2px;\r\n\t\tmargin-right: 6px;\r\n\t}\r\n\r\n\t.legend-label {\r\n\t\twhite-space: nowrap;\r\n\t}\r\n\r\n\t@media (max-width: 1200px) {\r\n\t\t.chart-legend-container {\r\n\t\t\tright: 20px;\r\n\t\t\ttop: 180px;\r\n\t\t\tflex-direction: column;\r\n\t\t\tmax-width: 200px;\r\n\t\t}\r\n\t}\r\n\r\n\t@media (max-width: 768px) {\r\n\t\t.chart-legend-container {\r\n\t\t\tposition: static;\r\n\t\t\tmax-width: 100%;\r\n\t\t\tmargin-bottom: 20px;\r\n\t\t\tbox-shadow: none;\r\n\t\t\tborder: 1px solid #eee;\r\n\t\t}\r\n\t}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}