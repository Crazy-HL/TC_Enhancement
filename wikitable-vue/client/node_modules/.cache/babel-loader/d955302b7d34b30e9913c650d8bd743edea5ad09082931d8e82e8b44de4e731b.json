{"ast":null,"code":"import { computed } from \"vue\";\nexport default {\n  __name: 'CommentStats',\n  props: {\n    comments: {\n      type: Array,\n      required: true\n    },\n    showStandpoint: {\n      type: Boolean,\n      default: true\n    },\n    showEmotion: {\n      type: Boolean,\n      default: true\n    }\n  },\n  setup(__props, _ref) {\n    let {\n      expose: __expose\n    } = _ref;\n    __expose();\n    const props = __props;\n\n    // 计算立场分布\n    const standpointStats = computed(() => {\n      const stats = {\n        support: 0,\n        oppose: 0,\n        neutral: 0,\n        total: 0\n      };\n      props.comments.forEach(comment => {\n        if (comment.standpoint === 1) stats.support++;else if (comment.standpoint === -1) stats.oppose++;else stats.neutral++;\n        stats.total++;\n      });\n      return stats;\n    });\n\n    // 立场tooltip\n    const standpointTooltip = computed(() => {\n      const {\n        support,\n        oppose,\n        neutral,\n        total\n      } = standpointStats.value;\n      if (total === 0) return \"无立场数据\";\n      const supportPct = Math.round(support / total * 100);\n      const opposePct = Math.round(oppose / total * 100);\n      const neutralPct = Math.round(neutral / total * 100);\n      return `支持 ${supportPct}% | 中立 ${neutralPct}% | 反对 ${opposePct}%`;\n    });\n\n    // 计算情感分布\n    const emotionStats = computed(() => {\n      const stats = {\n        positive: 0,\n        negative: 0,\n        neutral: 0,\n        total: 0\n      };\n      props.comments.forEach(comment => {\n        if (comment.emotion === 1) stats.positive++;else if (comment.emotion === -1) stats.negative++;else stats.neutral++;\n        stats.total++;\n      });\n      return stats;\n    });\n\n    // 情感tooltip\n    const emotionTooltip = computed(() => {\n      const {\n        positive,\n        negative,\n        neutral,\n        total\n      } = emotionStats.value;\n      if (total === 0) return \"无情感数据\";\n      const positivePct = Math.round(positive / total * 100);\n      const negativePct = Math.round(negative / total * 100);\n      const neutralPct = Math.round(neutral / total * 100);\n      return `积极 ${positivePct}% | 消极 ${negativePct}% | 中立 ${neutralPct}%`;\n    });\n\n    // 立场图表样式\n    const standpointStyle = computed(() => {\n      const {\n        support,\n        oppose,\n        neutral,\n        total\n      } = standpointStats.value;\n      if (total === 0) return {};\n      const supportHeight = Math.round(support / total * 100);\n      const neutralHeight = Math.round(neutral / total * 100);\n      const opposeHeight = Math.round(oppose / total * 100);\n      return {\n        \"--support-height\": `${supportHeight}%`,\n        \"--neutral-height\": `${neutralHeight}%`,\n        \"--oppose-height\": `${opposeHeight}%`\n      };\n    });\n\n    // 情感图表样式\n    const emotionStyle = computed(() => {\n      const {\n        positive,\n        negative,\n        neutral,\n        total\n      } = emotionStats.value;\n      if (total === 0) return {};\n      const positivePercent = Math.round(positive / total * 100);\n      const negativePercent = Math.round(negative / total * 100);\n      const neutralPercent = Math.round(neutral / total * 100);\n      return {\n        \"--positive-percent\": `${positivePercent}%`,\n        \"--negative-percent\": `${negativePercent}%`,\n        \"--neutral-percent\": `${neutralPercent}%`\n      };\n    });\n    const __returned__ = {\n      props,\n      standpointStats,\n      standpointTooltip,\n      emotionStats,\n      emotionTooltip,\n      standpointStyle,\n      emotionStyle,\n      computed\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["computed","props","__props","standpointStats","stats","support","oppose","neutral","total","comments","forEach","comment","standpoint","standpointTooltip","value","supportPct","Math","round","opposePct","neutralPct","emotionStats","positive","negative","emotion","emotionTooltip","positivePct","negativePct","standpointStyle","supportHeight","neutralHeight","opposeHeight","emotionStyle","positivePercent","negativePercent","neutralPercent"],"sources":["D:/ZhiHu/zhihu-bullet/wikitable-vue/client/src/components/CommentStats.vue"],"sourcesContent":["<template>\r\n\t<span class=\"comment-stats\">\r\n\t\t<!-- 立场堆叠图 (迷你纵向) -->\r\n\t\t<span\r\n\t\t\tv-if=\"showStandpoint\"\r\n\t\t\tclass=\"standpoint-chart\"\r\n\t\t\t:title=\"standpointTooltip\"\r\n\t\t\t:style=\"standpointStyle\">\r\n\t\t\t<span class=\"stacked-bar\">\r\n\t\t\t\t<span class=\"bar-segment support\"></span>\r\n\t\t\t\t<span class=\"bar-segment neutral\"></span>\r\n\t\t\t\t<span class=\"bar-segment oppose\"></span>\r\n\t\t\t</span>\r\n\t\t</span>\r\n\r\n\t\t<!-- 情感饼图 (迷你) -->\r\n\t\t<span\r\n\t\t\tv-if=\"showEmotion\"\r\n\t\t\tclass=\"emotion-chart\"\r\n\t\t\t:title=\"emotionTooltip\"\r\n\t\t\t:style=\"emotionStyle\"></span>\r\n\t</span>\r\n</template>\r\n\r\n<script setup>\r\n\timport { computed } from \"vue\";\r\n\r\n\tconst props = defineProps({\r\n\t\tcomments: {\r\n\t\t\ttype: Array,\r\n\t\t\trequired: true\r\n\t\t},\r\n\t\tshowStandpoint: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: true\r\n\t\t},\r\n\t\tshowEmotion: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: true\r\n\t\t}\r\n\t});\r\n\r\n\t// 计算立场分布\r\n\tconst standpointStats = computed(() => {\r\n\t\tconst stats = { support: 0, oppose: 0, neutral: 0, total: 0 };\r\n\r\n\t\tprops.comments.forEach(comment => {\r\n\t\t\tif (comment.standpoint === 1) stats.support++;\r\n\t\t\telse if (comment.standpoint === -1) stats.oppose++;\r\n\t\t\telse stats.neutral++;\r\n\t\t\tstats.total++;\r\n\t\t});\r\n\r\n\t\treturn stats;\r\n\t});\r\n\r\n\t// 立场tooltip\r\n\tconst standpointTooltip = computed(() => {\r\n\t\tconst { support, oppose, neutral, total } = standpointStats.value;\r\n\t\tif (total === 0) return \"无立场数据\";\r\n\r\n\t\tconst supportPct = Math.round((support / total) * 100);\r\n\t\tconst opposePct = Math.round((oppose / total) * 100);\r\n\t\tconst neutralPct = Math.round((neutral / total) * 100);\r\n\r\n\t\treturn `支持 ${supportPct}% | 中立 ${neutralPct}% | 反对 ${opposePct}%`;\r\n\t});\r\n\r\n\t// 计算情感分布\r\n\tconst emotionStats = computed(() => {\r\n\t\tconst stats = { positive: 0, negative: 0, neutral: 0, total: 0 };\r\n\r\n\t\tprops.comments.forEach(comment => {\r\n\t\t\tif (comment.emotion === 1) stats.positive++;\r\n\t\t\telse if (comment.emotion === -1) stats.negative++;\r\n\t\t\telse stats.neutral++;\r\n\t\t\tstats.total++;\r\n\t\t});\r\n\r\n\t\treturn stats;\r\n\t});\r\n\r\n\t// 情感tooltip\r\n\tconst emotionTooltip = computed(() => {\r\n\t\tconst { positive, negative, neutral, total } = emotionStats.value;\r\n\t\tif (total === 0) return \"无情感数据\";\r\n\r\n\t\tconst positivePct = Math.round((positive / total) * 100);\r\n\t\tconst negativePct = Math.round((negative / total) * 100);\r\n\t\tconst neutralPct = Math.round((neutral / total) * 100);\r\n\r\n\t\treturn `积极 ${positivePct}% | 消极 ${negativePct}% | 中立 ${neutralPct}%`;\r\n\t});\r\n\r\n\t// 立场图表样式\r\n\tconst standpointStyle = computed(() => {\r\n\t\tconst { support, oppose, neutral, total } = standpointStats.value;\r\n\t\tif (total === 0) return {};\r\n\r\n\t\tconst supportHeight = Math.round((support / total) * 100);\r\n\t\tconst neutralHeight = Math.round((neutral / total) * 100);\r\n\t\tconst opposeHeight = Math.round((oppose / total) * 100);\r\n\r\n\t\treturn {\r\n\t\t\t\"--support-height\": `${supportHeight}%`,\r\n\t\t\t\"--neutral-height\": `${neutralHeight}%`,\r\n\t\t\t\"--oppose-height\": `${opposeHeight}%`\r\n\t\t};\r\n\t});\r\n\r\n\t// 情感图表样式\r\n\tconst emotionStyle = computed(() => {\r\n\t\tconst { positive, negative, neutral, total } = emotionStats.value;\r\n\t\tif (total === 0) return {};\r\n\r\n\t\tconst positivePercent = Math.round((positive / total) * 100);\r\n\t\tconst negativePercent = Math.round((negative / total) * 100);\r\n\t\tconst neutralPercent = Math.round((neutral / total) * 100);\r\n\r\n\t\treturn {\r\n\t\t\t\"--positive-percent\": `${positivePercent}%`,\r\n\t\t\t\"--negative-percent\": `${negativePercent}%`,\r\n\t\t\t\"--neutral-percent\": `${neutralPercent}%`\r\n\t\t};\r\n\t});\r\n</script>\r\n\r\n<style scoped>\r\n\t.comment-stats {\r\n\t\tdisplay: inline-flex;\r\n\t\talign-items: center;\r\n\t\tvertical-align: middle;\r\n\t\tgap: 2px;\r\n\t\tmargin: 0 2px;\r\n\t\tline-height: 1;\r\n\t}\r\n\r\n\t/* 迷你立场堆叠图 (纵向) */\r\n\t.standpoint-chart {\r\n\t\tdisplay: inline-flex;\r\n\t\talign-items: flex-end;\r\n\t\twidth: 8px;\r\n\t\theight: 16px;\r\n\t}\r\n\r\n\t.stacked-bar {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tgap: 1px;\r\n\t}\r\n\r\n\t.bar-segment {\r\n\t\twidth: 100%;\r\n\t\tmin-height: 1px;\r\n\t\ttransition: height 0.2s ease;\r\n\t}\r\n\r\n\t.bar-segment.support {\r\n\t\tbackground-color: #4caf50;\r\n\t\theight: var(--support-height, 0%);\r\n\t}\r\n\r\n\t.bar-segment.neutral {\r\n\t\tbackground-color: #ffc107;\r\n\t\theight: var(--neutral-height, 0%);\r\n\t}\r\n\r\n\t.bar-segment.oppose {\r\n\t\tbackground-color: #f44336;\r\n\t\theight: var(--oppose-height, 0%);\r\n\t}\r\n\r\n\t/* 迷你情感饼图 */\r\n\t.emotion-chart {\r\n\t\tdisplay: inline-block;\r\n\t\twidth: 14px;\r\n\t\theight: 14px;\r\n\t\tborder-radius: 50%;\r\n\t\tbackground: conic-gradient(\r\n\t\t\t#4caf50 0% var(--positive-percent, 0%),\r\n\t\t\t#f44336 var(--positive-percent, 0%)\r\n\t\t\t\tcalc(var(--positive-percent, 0%) + var(--negative-percent, 0%)),\r\n\t\t\t#ffc107 calc(var(--positive-percent, 0%) + var(--negative-percent, 0%))\r\n\t\t\t\t100%\r\n\t\t);\r\n\t}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}