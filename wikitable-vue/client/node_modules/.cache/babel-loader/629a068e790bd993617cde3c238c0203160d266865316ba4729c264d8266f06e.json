{"ast":null,"code":"import { computed } from \"vue\";\nexport default {\n  __name: 'CommentStats',\n  props: {\n    comments: {\n      type: Array,\n      required: true\n    },\n    showType: {\n      type: Boolean,\n      default: false\n    }\n  },\n  setup(__props, _ref) {\n    let {\n      expose: __expose\n    } = _ref;\n    __expose();\n    const props = __props;\n\n    // 获取评论类型\n    const getCommentType = comment => {\n      return comment?.comment_type || 1;\n    };\n\n    // 获取评论类型标签\n    const getCommentTypeLabel = comment => {\n      const type = getCommentType(comment);\n      const types = {\n        1: \"陈述\",\n        2: \"疑问\",\n        3: \"感叹\",\n        4: \"建议\",\n        5: \"讽刺\"\n      };\n      return types[type] || \"陈述\";\n    };\n\n    // 计算类型统计数据\n    const typeStats = computed(() => {\n      const stats = {\n        statement: 0,\n        question: 0,\n        exclamation: 0,\n        suggestion: 0,\n        sarcasm: 0,\n        total: 0\n      };\n      props.comments.forEach(comment => {\n        const type = getCommentType(comment);\n        if (type === 1) stats.statement++;else if (type === 2) stats.question++;else if (type === 3) stats.exclamation++;else if (type === 4) stats.suggestion++;else if (type === 5) stats.sarcasm++;\n        stats.total++;\n      });\n      return {\n        statement: stats.statement,\n        question: stats.question,\n        exclamation: stats.exclamation,\n        suggestion: stats.suggestion,\n        sarcasm: stats.sarcasm,\n        total: stats.total\n      };\n    });\n\n    // 生成类型提示文本\n    const typeTooltip = computed(() => {\n      const {\n        statement,\n        question,\n        exclamation,\n        suggestion,\n        sarcasm,\n        total\n      } = typeStats.value;\n      if (total === 0) return \"无类型数据\";\n      const statementPct = Math.round(statement / total * 100);\n      const questionPct = Math.round(question / total * 100);\n      const exclamationPct = Math.round(exclamation / total * 100);\n      const suggestionPct = Math.round(suggestion / total * 100);\n      const sarcasmPct = Math.round(sarcasm / total * 100);\n      return `陈述: ${statement} (${statementPct}%)\n疑问: ${question} (${questionPct}%)\n感叹: ${exclamation} (${exclamationPct}%)\n建议: ${suggestion} (${suggestionPct}%)\n讽刺: ${sarcasm} (${sarcasmPct}%)`;\n    });\n\n    // 生成饼图样式\n    const pieChartStyle = computed(() => {\n      const {\n        statement,\n        question,\n        exclamation,\n        suggestion,\n        sarcasm,\n        total\n      } = typeStats.value;\n      if (total === 0) return {};\n      const statementPct = statement / total * 100;\n      const questionPct = question / total * 100;\n      const exclamationPct = exclamation / total * 100;\n      const suggestionPct = suggestion / total * 100;\n      const sarcasmPct = sarcasm / total * 100;\n      return {\n        background: `conic-gradient(\n        #4285f4 0% ${statementPct}%,\n        #ea4335 ${statementPct}% ${statementPct + questionPct}%,\n        #34a853 ${statementPct + questionPct}% ${statementPct + questionPct + exclamationPct}%,\n        #9c27b0 ${statementPct + questionPct + exclamationPct}% ${statementPct + questionPct + exclamationPct + suggestionPct}%,\n        #ff9800 ${statementPct + questionPct + exclamationPct + suggestionPct}% 100%\n      )`\n      };\n    });\n    const __returned__ = {\n      props,\n      getCommentType,\n      getCommentTypeLabel,\n      typeStats,\n      typeTooltip,\n      pieChartStyle,\n      computed\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["computed","props","__props","getCommentType","comment","comment_type","getCommentTypeLabel","type","types","typeStats","stats","statement","question","exclamation","suggestion","sarcasm","total","comments","forEach","typeTooltip","value","statementPct","Math","round","questionPct","exclamationPct","suggestionPct","sarcasmPct","pieChartStyle","background"],"sources":["D:/ZhiHu/zhihu-bullet/wikitable-vue/client/src/components/CommentStats.vue"],"sourcesContent":["<template>\r\n\t<span class=\"comment-stats\">\r\n\t\t<!-- 类型饼图 -->\r\n\t\t<span\r\n\t\t\tv-if=\"showType\"\r\n\t\t\tclass=\"type-pie-chart\"\r\n\t\t\t:title=\"typeTooltip\"\r\n\t\t\t:style=\"pieChartStyle\"></span>\r\n\t</span>\r\n</template>\r\n\r\n<script setup>\r\n\timport { computed } from \"vue\";\r\n\r\n\tconst props = defineProps({\r\n\t\tcomments: {\r\n\t\t\ttype: Array,\r\n\t\t\trequired: true\r\n\t\t},\r\n\t\tshowType: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: false\r\n\t\t}\r\n\t});\r\n\r\n\t// 获取评论类型\r\n\tconst getCommentType = comment => {\r\n\t\treturn comment?.comment_type || 1;\r\n\t};\r\n\r\n\t// 获取评论类型标签\r\n\tconst getCommentTypeLabel = comment => {\r\n\t\tconst type = getCommentType(comment);\r\n\t\tconst types = {\r\n\t\t\t1: \"陈述\",\r\n\t\t\t2: \"疑问\",\r\n\t\t\t3: \"感叹\",\r\n\t\t\t4: \"建议\",\r\n\t\t\t5: \"讽刺\"\r\n\t\t};\r\n\t\treturn types[type] || \"陈述\";\r\n\t};\r\n\r\n\t// 计算类型统计数据\r\n\tconst typeStats = computed(() => {\r\n\t\tconst stats = {\r\n\t\t\tstatement: 0,\r\n\t\t\tquestion: 0,\r\n\t\t\texclamation: 0,\r\n\t\t\tsuggestion: 0,\r\n\t\t\tsarcasm: 0,\r\n\t\t\ttotal: 0\r\n\t\t};\r\n\r\n\t\tprops.comments.forEach(comment => {\r\n\t\t\tconst type = getCommentType(comment);\r\n\t\t\tif (type === 1) stats.statement++;\r\n\t\t\telse if (type === 2) stats.question++;\r\n\t\t\telse if (type === 3) stats.exclamation++;\r\n\t\t\telse if (type === 4) stats.suggestion++;\r\n\t\t\telse if (type === 5) stats.sarcasm++;\r\n\t\t\tstats.total++;\r\n\t\t});\r\n\r\n\t\treturn {\r\n\t\t\tstatement: stats.statement,\r\n\t\t\tquestion: stats.question,\r\n\t\t\texclamation: stats.exclamation,\r\n\t\t\tsuggestion: stats.suggestion,\r\n\t\t\tsarcasm: stats.sarcasm,\r\n\t\t\ttotal: stats.total\r\n\t\t};\r\n\t});\r\n\r\n\t// 生成类型提示文本\r\n\tconst typeTooltip = computed(() => {\r\n\t\tconst { statement, question, exclamation, suggestion, sarcasm, total } =\r\n\t\t\ttypeStats.value;\r\n\t\tif (total === 0) return \"无类型数据\";\r\n\r\n\t\tconst statementPct = Math.round((statement / total) * 100);\r\n\t\tconst questionPct = Math.round((question / total) * 100);\r\n\t\tconst exclamationPct = Math.round((exclamation / total) * 100);\r\n\t\tconst suggestionPct = Math.round((suggestion / total) * 100);\r\n\t\tconst sarcasmPct = Math.round((sarcasm / total) * 100);\r\n\r\n\t\treturn `陈述: ${statement} (${statementPct}%)\r\n疑问: ${question} (${questionPct}%)\r\n感叹: ${exclamation} (${exclamationPct}%)\r\n建议: ${suggestion} (${suggestionPct}%)\r\n讽刺: ${sarcasm} (${sarcasmPct}%)`;\r\n\t});\r\n\r\n\t// 生成饼图样式\r\n\tconst pieChartStyle = computed(() => {\r\n\t\tconst { statement, question, exclamation, suggestion, sarcasm, total } =\r\n\t\t\ttypeStats.value;\r\n\t\tif (total === 0) return {};\r\n\r\n\t\tconst statementPct = (statement / total) * 100;\r\n\t\tconst questionPct = (question / total) * 100;\r\n\t\tconst exclamationPct = (exclamation / total) * 100;\r\n\t\tconst suggestionPct = (suggestion / total) * 100;\r\n\t\tconst sarcasmPct = (sarcasm / total) * 100;\r\n\r\n\t\treturn {\r\n\t\t\tbackground: `conic-gradient(\r\n        #4285f4 0% ${statementPct}%,\r\n        #ea4335 ${statementPct}% ${statementPct + questionPct}%,\r\n        #34a853 ${statementPct + questionPct}% ${\r\n\t\t\t\tstatementPct + questionPct + exclamationPct\r\n\t\t\t}%,\r\n        #9c27b0 ${statementPct + questionPct + exclamationPct}% ${\r\n\t\t\t\tstatementPct + questionPct + exclamationPct + suggestionPct\r\n\t\t\t}%,\r\n        #ff9800 ${\r\n\t\t\t\t\tstatementPct + questionPct + exclamationPct + suggestionPct\r\n\t\t\t\t}% 100%\r\n      )`\r\n\t\t};\r\n\t});\r\n</script>\r\n\r\n<style scoped>\r\n\t.comment-stats {\r\n\t\tdisplay: inline-flex;\r\n\t\talign-items: center;\r\n\t\tvertical-align: middle;\r\n\t\tgap: 4px;\r\n\t\tmargin: 0 2px;\r\n\t\tline-height: 1;\r\n\t}\r\n\r\n\t/* 类型饼图样式 */\r\n\t.type-pie-chart {\r\n\t\tdisplay: inline-block;\r\n\t\twidth: 16px;\r\n\t\theight: 16px;\r\n\t\tborder-radius: 50%;\r\n\t\tbackground: conic-gradient(#4285f4 0% 100%);\r\n\t}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}